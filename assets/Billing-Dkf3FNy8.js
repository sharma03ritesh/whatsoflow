import{r as n,j as e}from"./app-BizxXqg7.js";import{A as $,C as z}from"./app-sidebar-layout-CaMs9F-P.js";import{c as C,B as l}from"./button-BQ_HaO7-.js";import{C as m,a as h,b as u,d as D,c as p}from"./card-DySrz6MO.js";import{D as E,b as R,c as M,d as _,e as O,f as T}from"./dialog-CtonFf9y.js";import{B as S}from"./badge-DJri7UZe.js";import{L as k}from"./loader-circle-qK_5H3YY.js";import"./loading-spinner-BXfFPKXA.js";import"./index-DZiRmdSI.js";import"./index-3YIUB5mP.js";import"./index-BH0NSEIh.js";import"./app-logo-zSvHLsSz.js";import"./app-logo-icon-B8K9u0gq.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Y=C("ArrowUpRight",H);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Z=C("Download",V),q=[{id:"starter",name:"Starter",price:29,interval:"monthly",features:["Up to 1,000 messages/month","Basic automation","Email support","5 integrations"]},{id:"professional",name:"Professional",price:79,interval:"monthly",features:["Up to 10,000 messages/month","Advanced automation","Priority support","Unlimited integrations","Custom webhooks"],popular:!0},{id:"enterprise",name:"Enterprise",price:199,interval:"monthly",features:["Unlimited messages","All automation features","24/7 dedicated support","Custom integrations","Advanced analytics","SLA guarantee"]}];function le(){const[s,x]=n.useState(null),[g,f]=n.useState([]),[P,A]=n.useState(!0),[j,w]=n.useState(!1),[N,i]=n.useState(null),[I,o]=n.useState(!1),[y,B]=n.useState(null);n.useEffect(()=>{b(),U()},[]);const b=async()=>{try{i(null);let t;if(window.axios)t=await window.axios.get("/api/billing",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});else{const a=await fetch("/api/billing",{headers:{Accept:"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(!a.ok)throw new Error("Failed to fetch billing data");t={data:await a.json()}}x(t.data)}catch(t){i(t.response?.data?.message||t.message||"Failed to load billing data"),x({currentPlan:{name:"Professional",price:79,interval:"monthly",renewalDate:new Date(Date.now()+720*60*60*1e3).toISOString(),status:"active"}})}finally{A(!1)}},U=async()=>{try{let t;if(window.axios)t=await window.axios.get("/api/billing/invoices",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});else{const a=await fetch("/api/billing/invoices",{headers:{Accept:"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`}});if(!a.ok)throw new Error("Failed to fetch invoices");t={data:await a.json()}}f(t.data||[])}catch(t){console.error("Failed to fetch invoices:",t),f([{id:1,invoiceNumber:"INV-2024-001",amount:79,status:"paid",issueDate:"2024-01-01T00:00:00Z",dueDate:"2024-01-15T00:00:00Z"}])}},L=async t=>{try{w(!0),i(null);let a;if(window.axios)a=await window.axios.post("/api/billing/upgrade",{planId:t},{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});else{const r=await fetch("/api/billing/upgrade",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify({planId:t})});if(!r.ok)throw{response:{data:await r.json().catch(()=>({}))},status:r.status};a={data:await r.json()}}o(!1),B(null),b()}catch(a){i(a.response?.data?.message||a.message||"Failed to upgrade plan")}finally{w(!1)}},c=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),d=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),v=t=>{const a={paid:"default",active:"default",pending:"secondary",failed:"destructive",cancelled:"outline",expired:"outline"};return e.jsx(S,{variant:a[t]||"outline",children:t.charAt(0).toUpperCase()+t.slice(1)})},F=t=>{if(t.downloadUrl)window.open(t.downloadUrl,"_blank");else{const a=`/api/billing/invoices/${t.id}/download`;window.open(a,"_blank")}};return e.jsx($,{breadcrumbs:[{title:"Billing",href:"/billing"}],children:e.jsxs("div",{className:"space-y-6 p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your subscription and view invoices"})]}),e.jsxs(l,{onClick:()=>o(!0),children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Upgrade Plan"]})]}),N&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-800 border border-red-200",children:N}),P?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(k,{className:"h-8 w-8 animate-spin mx-auto mb-2"}),"Loading billing information..."]}):e.jsxs(e.Fragment,{children:[s&&e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Current Plan"}),e.jsx(D,{children:"Your active subscription details"})]}),e.jsx(p,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-2xl font-bold",children:s.currentPlan.name}),v(s.currentPlan.status)]}),e.jsxs("p",{className:"text-muted-foreground mt-1",children:[d(s.currentPlan.price),"/",s.currentPlan.interval==="monthly"?"month":"year"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Renewal Date"}),e.jsx("p",{className:"text-lg font-semibold",children:c(s.currentPlan.renewalDate)})]})]})})]}),e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsx(u,{children:"Invoice History"}),e.jsx(D,{children:"View and download your past invoices"})]}),e.jsx(p,{children:g.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"No invoices found"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-4 font-semibold",children:"Invoice Number"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Amount"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Status"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Issue Date"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Due Date"}),e.jsx("th",{className:"text-left p-4 font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:g.map(t=>e.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.invoiceNumber}),e.jsx("td",{className:"p-4",children:d(t.amount)}),e.jsx("td",{className:"p-4",children:v(t.status)}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:c(t.issueDate)}),e.jsx("td",{className:"p-4 text-sm text-muted-foreground",children:c(t.dueDate)}),e.jsx("td",{className:"p-4",children:e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>F(t),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Download"]})})]},t.id))})]})})})]})]}),e.jsx(E,{open:I,onOpenChange:o,children:e.jsxs(R,{className:"sm:max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(M,{children:[e.jsx(_,{children:"Upgrade Your Plan"}),e.jsx(O,{children:"Choose a plan that fits your needs. You can change or cancel anytime."})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-3 py-4",children:q.map(t=>e.jsxs(m,{className:`relative ${t.popular?"border-primary ring-2 ring-primary":""}`,children:[t.popular&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx(S,{children:"Most Popular"})}),e.jsxs(h,{children:[e.jsx(u,{children:t.name}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-3xl font-bold",children:d(t.price)}),e.jsxs("span",{className:"text-muted-foreground",children:["/",t.interval==="monthly"?"mo":"yr"]})]})]}),e.jsxs(p,{className:"space-y-4",children:[e.jsx("ul",{className:"space-y-2",children:t.features.map((a,r)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[e.jsx(z,{className:"h-4 w-4 mt-0.5 text-primary shrink-0"}),e.jsx("span",{children:a})]},r))}),e.jsx(l,{className:"w-full",variant:t.popular?"default":"outline",onClick:()=>L(t.id),disabled:j||y===t.id||s?.currentPlan.name===t.name,children:j&&y===t.id?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):s?.currentPlan.name===t.name?"Current Plan":"Select Plan"})]})]},t.id))}),e.jsx(T,{children:e.jsx(l,{variant:"outline",onClick:()=>o(!1),children:"Cancel"})})]})})]})})}export{le as default};
