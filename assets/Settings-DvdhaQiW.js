import{r as i,j as e}from"./app-BizxXqg7.js";import{A as k,C as P}from"./app-sidebar-layout-CaMs9F-P.js";import{B as z}from"./button-BQ_HaO7-.js";import{C as p,a as x,b as u,d as g,c as j}from"./card-DySrz6MO.js";import{I as o}from"./input-V6jPku_u.js";import{L as r}from"./label-D43lO-9X.js";import{S as f}from"./switch-JSzLyKdu.js";import{L as C}from"./loader-circle-qK_5H3YY.js";import{S as B}from"./save-CU-1-yFF.js";import"./loading-spinner-BXfFPKXA.js";import"./index-DZiRmdSI.js";import"./index-3YIUB5mP.js";import"./index-BH0NSEIh.js";import"./app-logo-zSvHLsSz.js";import"./app-logo-icon-B8K9u0gq.js";function G(){const[a,l]=i.useState({profile:{name:"",email:"",company:""},whatsapp:{token:"",phoneNumber:""},integrations:{crm:!1,zapier:!1,webhooks:!1}}),[A,y]=i.useState(!0),[N,b]=i.useState(!1),[w,c]=i.useState(null),[v,d]=i.useState(!1);i.useEffect(()=>{I()},[]);const I=async()=>{try{y(!0),c(null);let s;if(window.axios)try{s=await window.axios.get("/api/settings",{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}}),s.data&&l(s.data)}catch{console.log("No settings endpoint, using defaults")}}catch(s){console.error("Failed to fetch settings:",s)}finally{y(!1)}},F=async()=>{try{b(!0),c(null),d(!1);let s;if(window.axios)s=await window.axios.post("/api/settings/update",a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")||""}`}});else{const t=await fetch("/api/settings/update",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${localStorage.getItem("token")||""}`},body:JSON.stringify(a)});if(!t.ok)throw{response:{data:await t.json().catch(()=>({}))},status:t.status};s={data:await t.json()}}d(!0),setTimeout(()=>d(!1),3e3)}catch(s){c(s.response?.data?.message||s.message||"Failed to save settings")}finally{b(!1)}},m=(s,t)=>{l(n=>({...n,profile:{...n.profile,[s]:t}}))},S=(s,t)=>{l(n=>({...n,whatsapp:{...n.whatsapp,[s]:t}}))},h=s=>{l(t=>({...t,integrations:{...t.integrations,[s]:!t.integrations[s]}}))};return A?e.jsx(k,{breadcrumbs:[{title:"Settings",href:"/settings"}],children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"h-8 w-8 animate-spin mx-auto text-muted-foreground"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading settings..."})]})})}):e.jsx(k,{breadcrumbs:[{title:"Settings",href:"/settings"}],children:e.jsxs("div",{className:"space-y-6 p-4 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Manage your account settings and integrations"})]}),e.jsx(z,{onClick:F,disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):v?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Saved"]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]}),w&&e.jsx("div",{className:"rounded-md bg-red-50 p-4 text-sm text-red-800 border border-red-200",children:w}),v&&e.jsx("div",{className:"rounded-md bg-green-50 p-4 text-sm text-green-800 border border-green-200",children:"Settings saved successfully!"}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"Profile Settings"}),e.jsx(g,{children:"Update your personal information and company details"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"name",children:"Name"}),e.jsx(o,{id:"name",type:"text",placeholder:"Your full name",value:a.profile.name,onChange:s=>m("name",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"email",children:"Email"}),e.jsx(o,{id:"email",type:"email",placeholder:"your.email@example.com",value:a.profile.email,onChange:s=>m("email",s.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"company",children:"Company"}),e.jsx(o,{id:"company",type:"text",placeholder:"Your company name",value:a.profile.company,onChange:s=>m("company",s.target.value)})]})]})]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsx(u,{children:"WhatsApp API Settings"}),e.jsx(g,{children:"Configure your WhatsApp Business API credentials"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"token",children:"API Token"}),e.jsx(o,{id:"token",type:"password",placeholder:"Enter your WhatsApp API token",value:a.whatsapp.token,onChange:s=>S("token",s.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your WhatsApp Business API token"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(r,{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx(o,{id:"phoneNumber",type:"tel",placeholder:"+1234567890",value:a.whatsapp.phoneNumber,onChange:s=>S("phoneNumber",s.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"WhatsApp Business phone number"})]})]})]}),e.jsxs(p,{className:"lg:col-span-2",children:[e.jsxs(x,{children:[e.jsx(u,{children:"Integrations"}),e.jsx(g,{children:"Enable or disable third-party integrations"})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{htmlFor:"crm",className:"text-base",children:"CRM Integration"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with your CRM system to sync leads and contacts"})]}),e.jsx(f,{id:"crm",checked:a.integrations.crm,onCheckedChange:()=>h("crm")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{htmlFor:"zapier",className:"text-base",children:"Zapier Integration"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automate workflows with Zapier connections"})]}),e.jsx(f,{id:"zapier",checked:a.integrations.zapier,onCheckedChange:()=>h("zapier")})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(r,{htmlFor:"webhooks",className:"text-base",children:"Webhooks"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send real-time events to your webhook endpoints"})]}),e.jsx(f,{id:"webhooks",checked:a.integrations.webhooks,onCheckedChange:()=>h("webhooks")})]})]})})]})]})]})})}export{G as default};
